import{e as n}from"./app.dbf5d933.js";import{_ as s}from"./plugin-vue_export-helper.21dcd24c.js";const a={},e=n(`<h2 id="\u524D\u8A00" tabindex="-1"><a class="header-anchor" href="#\u524D\u8A00" aria-hidden="true">#</a> \u524D\u8A00</h2><p>\u7CFB\u7EDF\u4E2D\u6709\u4E9B\u5730\u65B9\u4F1A\u8FDB\u884C\u8D44\u6E90\u7684\u9650\u5236\uFF0C\u5176\u4E2D\u7684\u4E00\u4E2A\u5C31\u662F open file \u7684\u9650\u5236\uFF0C\u64CD\u4F5C\u7CFB\u7EDF\u9ED8\u8BA4\u9650\u5236\u7684\u662F 1024, \u8FD9\u4E2A\u503C\u53EF\u4EE5\u901A\u8FC7\u5404\u79CD\u65B9\u5F0F\u4FEE\u6539\uFF0C\u672C\u7BC7\u4E3B\u8981\u8BB2\u7684\u662F\u5982\u4F55\u5728\u7EBF\u4FEE\u6539\uFF0C\u751F\u4EA7\u4E0A\u662F\u4E0D\u53EF\u80FD\u968F\u4FBF\u91CD\u542F\u8FDB\u7A0B\u7684\u3002</p><h2 id="\u5B9E\u8DF5" tabindex="-1"><a class="header-anchor" href="#\u5B9E\u8DF5" aria-hidden="true">#</a> \u5B9E\u8DF5</h2><h3 id="\u67E5\u770B\u7CFB\u7EDF\u9ED8\u8BA4\u7684\u9650\u5236" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u7CFB\u7EDF\u9ED8\u8BA4\u7684\u9650\u5236" aria-hidden="true">#</a> \u67E5\u770B\u7CFB\u7EDF\u9ED8\u8BA4\u7684\u9650\u5236</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@lab8106 ~<span class="token punctuation">]</span><span class="token comment"># ulimit -a|grep open</span>
<span class="token function">open</span> files                      <span class="token punctuation">(</span>-n<span class="token punctuation">)</span> <span class="token number">1024</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u9ED8\u8BA4\u7684\u6253\u5F00\u6587\u4EF6\u662F 1024\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">ps</span> aux <span class="token operator">|</span><span class="token function">grep</span> nginx
root       <span class="token number">5648</span>  <span class="token number">0.0</span>  <span class="token number">0.2</span>  <span class="token number">46184</span>  <span class="token number">2216</span> ?        Ss   <span class="token number">15</span>:23   <span class="token number">0</span>:00 nginx: master process nginx
www        <span class="token number">5709</span>  <span class="token number">0.0</span>  <span class="token number">0.6</span>  <span class="token number">50780</span>  <span class="token number">6676</span> ?        S    <span class="token number">15</span>:43   <span class="token number">0</span>:00 nginx: worker process
root       <span class="token number">7044</span>  <span class="token number">0.0</span>  <span class="token number">0.0</span> <span class="token number">112728</span>   <span class="token number">984</span> pts/1    R+   <span class="token number">17</span>:16   <span class="token number">0</span>:00 <span class="token function">grep</span> --color<span class="token operator">=</span>auto nginx
$ <span class="token function">cat</span> /proc/5648/limits <span class="token operator">|</span><span class="token function">grep</span> <span class="token function">open</span>
Max <span class="token function">open</span> files            <span class="token number">10200</span>                <span class="token number">10200</span>                files
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Nginx \u7684\u8FDB\u7A0B\u7684\u8FD9\u4E2A\u53C2\u6570\u662F 10200\u3002</p><h3 id="\u901A\u8FC7\u914D\u7F6E\u6587\u4EF6\u4FEE\u6539" tabindex="-1"><a class="header-anchor" href="#\u901A\u8FC7\u914D\u7F6E\u6587\u4EF6\u4FEE\u6539" aria-hidden="true">#</a> \u901A\u8FC7\u914D\u7F6E\u6587\u4EF6\u4FEE\u6539</h3><p>\u8FD9\u4E2A\u53C2\u6570\u63A7\u5236\u662F\u653E\u5728\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">cat</span> /usr/local/nginx/conf/nginx.conf <span class="token operator">|</span><span class="token function">grep</span> worker_rlimit_nofile
worker_rlimit_nofile <span class="token number">10200</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u8FD9\u4E2A\u5730\u65B9\u8BBE\u7F6E\u7684\uFF0C\u5982\u679C\u6211\u4EEC\u6709\u9700\u8981\u4FEE\u6539\uFF0C\u90A3\u4E48\u53EF\u4EE5\u4FEE\u6539\u8FD9\u91CC\uFF0C\u8FD9\u4E0D\u662F\u672C\u7BC7\u7684\u91CD\u70B9\uFF0C\u5BF9\u4E8E\u8FD0\u884C\u4E2D\u7684\u8FDB\u7A0B\u5982\u4F55\u4FEE\u6539\u5462\u3002</p><p><img src="http://t.eryajf.net/imgs/2021/09/eb822448b9245173.jpg" alt="img"></p><h3 id="\u5728\u7EBF\u4FEE\u6539\u8FDB\u7A0B\u7684-limit" tabindex="-1"><a class="header-anchor" href="#\u5728\u7EBF\u4FEE\u6539\u8FDB\u7A0B\u7684-limit" aria-hidden="true">#</a> \u5728\u7EBF\u4FEE\u6539\u8FDB\u7A0B\u7684 limit</h3><p>\u8FD9\u91CC\u8C03\u7528\u7684\u662F prlimit \u8FDB\u884C\u7684\u5728\u7EBF\u4FEE\u6539 \u67E5\u8BE2\u6307\u5B9A\u8FDB\u7A0B\u7684\u9650\u5236</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token variable">$prlimit</span> --pid <span class="token number">5648</span>
RESOURCE   DESCRIPTION                             SOFT      HARD UNITS
AS         address space limit                unlimited unlimited \u5B57\u8282
CORE       max core <span class="token function">file</span> size                         <span class="token number">0</span> unlimited \u5757
CPU        CPU <span class="token function">time</span>                           unlimited unlimited \u79D2\u6570
DATA       max data size                      unlimited unlimited \u5B57\u8282
FSIZE      max <span class="token function">file</span> size                      unlimited unlimited \u5757
LOCKS      max number of <span class="token function">file</span> locks held      unlimited unlimited
MEMLOCK    max locked-in-memory address space     <span class="token number">65536</span>     <span class="token number">65536</span> \u5B57\u8282
MSGQUEUE   max bytes <span class="token keyword">in</span> POSIX mqueues            <span class="token number">819200</span>    <span class="token number">819200</span> \u5B57\u8282
NICE       max <span class="token function">nice</span> prio allowed to raise             <span class="token number">0</span>         <span class="token number">0</span>
NOFILE     max number of <span class="token function">open</span> files               <span class="token number">10200</span>     <span class="token number">10200</span>
NPROC      max number of processes                 <span class="token number">3819</span>      <span class="token number">3819</span>
RSS        max resident <span class="token builtin class-name">set</span> size              unlimited unlimited \u9875\u6570
RTPRIO     max real-time priority                     <span class="token number">0</span>         <span class="token number">0</span>
RTTIME     <span class="token function">timeout</span> <span class="token keyword">for</span> real-time tasks        unlimited unlimited \u6BEB\u79D2\u6570
SIGPENDING max number of pending signals           <span class="token number">3819</span>      <span class="token number">3819</span>
STACK      max stack size                       <span class="token number">8388608</span> unlimited \u5B57\u8282
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>\u4FEE\u6539\u6307\u5B9A\u8FD0\u884C\u8FDB\u7A0B\u7684\u9650\u5236</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@lab8106 ~<span class="token punctuation">]</span><span class="token comment"># prlimit --pid 5648 --nofile=65535</span>
<span class="token punctuation">[</span>root@lab8106 ~<span class="token punctuation">]</span><span class="token comment"># prlimit --pid 5648 |grep NOFILE</span>
NOFILE     max number of <span class="token function">open</span> files              <span class="token number">65535</span>    <span class="token number">65535</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u53EF\u4EE5\u770B\u5230\u4FEE\u6539\u6210\u529F\u4E86\u3002</p><h2 id="\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u603B\u7ED3" aria-hidden="true">#</a> \u603B\u7ED3</h2><p>\u4E00\u822C\u6765\u8BF4 ulimit \u8FD9\u4E2A\u9650\u5236\u90FD\u662F\u5728\u7EC8\u7AEF\u4E0A\u4FEE\u6539\u5BF9\u4E0B\u6B21\u751F\u6548\uFF0C\u672C\u7BC7\u7528\u6765\u8BB0\u5F55\u5982\u4F55\u5728\u7EBF\u4FEE\u6539\uFF0C\u5982\u679C\u78B0\u5230\u4E86\uFF0C\u53EF\u4EE5\u8FD9\u6837\u5904\u7406\u3002</p>`,21);function p(l,r){return e}var c=s(a,[["render",p]]);export{c as default};

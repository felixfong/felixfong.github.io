import{e as n}from"./app.dbf5d933.js";import{_ as s}from"./plugin-vue_export-helper.21dcd24c.js";const a={},e=n(`<p>\u516C\u53F8\u539F\u6709\u7684\u6D4B\u8BD5\u6570\u636E\u5E93\u5728\u4E3B\u673A<code>192.168.10.5</code>\u4E0A\u8FB9\uFF0C\u73B0\u5728\u6570\u636E\u5E93\u8F6C\u79FB\u5230\u4E86<code>192.168.10.4</code>\u4E0A\uFF0C\u4E3A\u4E86\u4E0D\u8BA9\u5404\u4E2A\u5730\u65B9\u90FD\u9700\u8981\u66F4\u6539\u5730\u5740\uFF0C\u73B0\u5728\u9700\u8981\u4E00\u4E2A\u56DB\u5C42\u4EE3\u7406\u5DE5\u5177\uFF0C\u5C06\u539F\u6765\u8BF7\u6C42\u5230<code>192.168.10.5</code>\u7684<code>3306</code>\u7AEF\u53E3\u8F6C\u53D1\u5230<code>192.168.10.4</code>\u7684<code>3306</code>\u7AEF\u53E3\u3002</p><p>\u8FD9\u4E2A\u5DE5\u5177\uFF0C\u7528\u5230\u4E86 nginx \u7684\u56DB\u5C42\u4EE3\u7406\u3002</p><p>\u5B98\u65B9\u6587\u6863\uFF1Ahttp://nginx.org/en/docs/stream/ngx_stream_core_module.html</p><p>\u56DB\u5C42\u4EE3\u7406\u4F9D\u8D56\u6A21\u5757<code>ngx_stream_core_module</code>\uFF0C\u8BE5\u6A21\u5757\u81EA 1.9.0 \u7248\u5F00\u59CB\u53EF\u7528\u3002\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u6B64\u6A21\u5757\u4E0D\u6784\u5EFA\uFF0C\u5E94\u4F7F\u7528\u914D\u7F6E\u53C2\u6570\u542F\u7528 <code>--with-stream</code>\u3002</p><p>\u5B89\u88C5\u8FC7\u7A0B\u7B80\u793A\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@linux-node1 src<span class="token punctuation">]</span><span class="token comment"># tar xf nginx-1.10.3.tar.gz </span>
<span class="token punctuation">[</span>root@linux-node1 src<span class="token punctuation">]</span><span class="token comment"># cd nginx-1.10.3</span>
<span class="token punctuation">[</span>root@linux-node1 nginx-1.10.3<span class="token punctuation">]</span><span class="token comment"># useradd -s /sbin/nologin -M www</span>
<span class="token punctuation">[</span>root@linux-node1 nginx-1.10.3<span class="token punctuation">]</span><span class="token comment"># yum install gcc gcc-c++ zlib-devel pcre-devel openssl openssl-devel -y</span>
<span class="token punctuation">[</span>root@linux-node1 nginx-1.10.3<span class="token punctuation">]</span><span class="token comment"># ./configure --prefix=/usr/local/nginx-1.10.3 --user=www --group=www --with-http_ssl_module --with-http_stub_status_module --with-file-aio --with-stream</span>
<span class="token punctuation">[</span>root@linux-node1 nginx-1.10.3<span class="token punctuation">]</span><span class="token comment"># make &amp;&amp; make install </span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>\u53EF\u4EE5\u901A\u8FC7<code>nginx -V</code>\u67E5\u770B\u4E00\u4E0B\u662F\u5426\u5C06\u4E0A\u8FF0\u6A21\u5757\u7F16\u8BD1\u8FDB\u6765\uFF0C\u5982\u679C\u6CA1\u6709\uFF0C\u53EF\u4EE5\u91CD\u65B0\u7F16\u8BD1\u4E00\u4E0B\u3002</p><p><img src="http://t.eryajf.net/imgs/2021/09/953bc15ab5687cd0.jpg" alt="image"></p><p>\u6765\u5230\u4E3B\u914D\u7F6E\uFF1A</p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">worker_processes</span>  <span class="token number">1</span></span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">events</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">worker_connections</span>  <span class="token number">1024</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token directive"><span class="token keyword">stream</span></span> <span class="token punctuation">{</span>  
        <span class="token directive"><span class="token keyword">upstream</span> tcp_proxy</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">hash</span> <span class="token variable">$remote_addr</span> consistent</span><span class="token punctuation">;</span>  <span class="token comment">#\u8FDC\u7A0B\u5730\u5740\u505A\u4E2Ahash</span>
        <span class="token directive"><span class="token keyword">server</span> 192.168.10.4:22</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
      <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">listen</span> <span class="token number">2222</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_connect_timeout</span> <span class="token number">1s</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_timeout</span> <span class="token number">10s</span></span><span class="token punctuation">;</span>  <span class="token comment">#\u540E\u7AEF\u8FDE\u63A5\u8D85\u65F6\u65F6\u95F4</span>
        <span class="token directive"><span class="token keyword">proxy_pass</span> tcp_proxy</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>\u6B64\u914D\u7F6E\u662F\u5C06\u672C\u673A\u7684 2222 \u7AEF\u53E3\u8F6C\u53D1\u5230 192.168.10.4 \u7684 22 \u7AEF\u53E3\uFF0C\u914D\u7F6E\u4E4B\u540E\uFF0C\u8BD5\u9A8C\u4E00\u4E0B\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@7-3 nginx<span class="token punctuation">]</span><span class="token variable">$ssh</span> -p <span class="token number">2222</span> root@192.168.10.5
The authenticity of <span class="token function">host</span> <span class="token string">&#39;[192.168.10.5]:2222 ([192.168.10.5]:2222)&#39;</span> can<span class="token string">&#39;t be established.
ECDSA key fingerprint is 05:2f:63:e9:87:be:b4:44:d3:d7:77:a0:52:e0:4f:2f.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added &#39;</span><span class="token punctuation">[</span><span class="token number">192.168</span>.10.5<span class="token punctuation">]</span>:2222<span class="token string">&#39; (ECDSA) to the list of known hosts.
root@192.168.10.5&#39;</span>s password:
Last login: Wed Nov  <span class="token number">7</span> <span class="token number">15</span>:24:33 <span class="token number">2018</span> from <span class="token number">192.168</span>.10.1
<span class="token punctuation">[</span>root@7-2 ~<span class="token punctuation">]</span><span class="token variable">$hostname</span> -I
<span class="token number">192.168</span>.10.4
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>\u521A\u521A\u8BBE\u7F6E\u4E86 10 \u7684\u8D85\u65F6\uFF0C\u5982\u679C\u9700\u8981\u7684\u8BDD\uFF0C\u53EF\u4EE5\u5C06\u4E4B\u6CE8\u91CA\u6389\u3002</p><p>\u540C\u7406\uFF0C\u914D\u7F6E\u6570\u636E\u5E93\u7AEF\u53E3\u7684\u8F6C\u53D1\u4E5F\u5C31\u975E\u5E38\u7B80\u5355\u4E86\uFF1A</p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">worker_processes</span>  <span class="token number">1</span></span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">events</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">worker_connections</span>  <span class="token number">1024</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token directive"><span class="token keyword">stream</span></span> <span class="token punctuation">{</span>  
        <span class="token directive"><span class="token keyword">upstream</span> tcp_proxy</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">hash</span> <span class="token variable">$remote_addr</span> consistent</span><span class="token punctuation">;</span>  <span class="token comment">#\u8FDC\u7A0B\u5730\u5740\u505A\u4E2Ahash</span>
        <span class="token directive"><span class="token keyword">server</span> 192.168.10.4:3306</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
      <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">listen</span> <span class="token number">3306</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_connect_timeout</span> <span class="token number">1s</span></span><span class="token punctuation">;</span>
       <span class="token comment"># proxy_timeout 10s;  #\u540E\u7AEF\u8FDE\u63A5\u8D85\u65F6\u65F6\u95F4</span>
        <span class="token directive"><span class="token keyword">proxy_pass</span> tcp_proxy</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>\u8FD9\u6837\u4E00\u6765\uFF0C\u7528\u6237\u8FDE\u63A5<code>192.168.10.5:3306</code>\u7684\u65F6\u5019\uFF0C\u5C31\u4F1A\u88AB\u8F6C\u53D1\u5230<code>192.168.10.4:3306</code>\u4E86\u3002</p><p>\u672C\u6587\u53C2\u8003\u5730\u5740\uFF1Ahttps://www.cnblogs.com/w787815/p/6682824.html</p>`,17);function p(t,c){return e}var r=s(a,[["render",p]]);export{r as default};

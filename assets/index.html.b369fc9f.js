import{r as p,o as l,c as r,b as n,a as e,F as t,d as s,e as c}from"./app.dbf5d933.js";import{_ as i}from"./plugin-vue_export-helper.21dcd24c.js";const o={},u=n("p",null,"\u6E90\u7801\u5305\u6709\u6E90\u7801\u5305\u7684\u7075\u6D3B\uFF0CRPM\u5305\u6709RPM\u5305\u7684\u65B9\u4FBF\uFF0C\u4E00\u4E9B\u6BD4\u8F83\u5E38\u7528\u7684\u751F\u4EA7\u5DE5\u5177\u5305\uFF0C\u6253\u6210RPM\u5305\u8FD8\u662F\u6BD4\u8F83\u65B9\u4FBF\u7684\u3002",-1),b=n("h2",{id:"_1-\u7269\u6599",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_1-\u7269\u6599","aria-hidden":"true"},"#"),s(" 1\uFF0C\u7269\u6599")],-1),m={href:"https://openresty.org/cn/",target:"_blank",rel:"noopener noreferrer"},d=s("openresty\u5B98\u7F51"),g={href:"https://github.com/openresty/openresty-packaging",target:"_blank",rel:"noopener noreferrer"},k=s("openresty-packaging"),h=s("\uFF1A\u5B98\u65B9\u7EF4\u62A4\u7684RPM\u6784\u5EFA\u7684\u57FA\u7840\u6587\u4EF6\u3002"),y=c(`<h2 id="_2-\u6211\u7684" tabindex="-1"><a class="header-anchor" href="#_2-\u6211\u7684" aria-hidden="true">#</a> 2\uFF0C\u6211\u7684</h2><p>\u5B98\u65B9\u63D0\u4F9B\u7684\u5305\u5927\u591A\u7ED9\u7684\u662F\u9ED8\u8BA4\u914D\u7F6E\uFF0C\u4E0D\u5927\u9002\u5408\u5728\u751F\u4EA7\u76F4\u63A5\u4F7F\u7528\uFF0C\u56E0\u6B64\u501F\u9274\u5B98\u65B9\u7684\u5305\u8FDB\u884C\u4E86\u4E00\u4E9B\u7B80\u5355\u7684\u8C03\u6574\u6539\u9020\uFF0C\u5E76\u5C06\u57FA\u7840\u6587\u4EF6\u6574\u7406\u6210\u4E86\u9879\u76EE\uFF1A</p><p>::: cardList 1</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> rpmbuild
  <span class="token key atrule">desc</span><span class="token punctuation">:</span> \u5DE5\u4F5C\u4E2D\u5E38\u7528\u7684RPM\u6784\u5EFAspec
  <span class="token key atrule">avatar</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//avatars2.githubusercontent.com/u/416130<span class="token punctuation">?</span>s=460<span class="token important">&amp;u=8753e86600e300a9811cdc539aa158deec2e2724&amp;v=4</span> <span class="token comment"># \u53EF\u9009</span>
  <span class="token key atrule">link</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/eryajf/rpmbuild <span class="token comment"># \u53EF\u9009</span>
  <span class="token key atrule">bgColor</span><span class="token punctuation">:</span> <span class="token string">&#39;#FBDE4B&#39;</span> <span class="token comment"># \u53EF\u9009\uFF0C\u9ED8\u8BA4var(--bodyBg)\u3002\u989C\u8272\u503C\u6709#\u53F7\u65F6\u8BF7\u6DFB\u52A0\u5355\u5F15\u53F7</span>
  <span class="token key atrule">textColor</span><span class="token punctuation">:</span> <span class="token string">&#39;#fff&#39;</span> <span class="token comment"># \u53EF\u9009\uFF0C\u9ED8\u8BA4var(--textColor)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>:::</p><p>\u8C03\u6574\u8BF4\u660E\u5982\u4E0B\uFF1A</p><ul><li><p>\u66FF\u6362\u4E86\u9ED8\u8BA4\u7684nginx.conf\u6587\u4EF6\u5185\u5BB9</p><ul><li><p>\u8C03\u6574\u65E5\u5FD7\u683C\u5F0F\u4E3Ajson\uFF0C\u65E5\u5FD7\u8DEF\u5F84\u5982\u4E0B</p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">error_log</span> /data/log/error.log</span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">access_log</span> /data/log/tmp.log json</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li><li><p>\u8C03\u6574\u652F\u6301\u4F20\u9012\u5E26\u6709\u4E0B\u5212\u7EBF\u7684header\u3002</p></li></ul></li><li><p>\u4E3B\u52A8\u521B\u5EFA\u4E00\u4E9B\u8F6F\u94FE\uFF0C\u4FBF\u4E8E\u7EF4\u62A4\u6216\u8005\u89C4\u8303</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">ln</span> -snf /usr/local/openresty/nginx/sbin/nginx /usr/sbin/nginx
<span class="token function">ln</span> -snf /usr/local/openresty/nginx/conf /etc/nginx
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li><li><p>\u6DFB\u52A0\u57FA\u4E8Elogrotate\u7684\u65E5\u5FD7\u6E05\u7406\u7B56\u7565</p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code>/data/log/tmp.log
/data/log/error.log
<span class="token punctuation">{</span>
    daily
    dateext
    missingok
    rotate 7
    notifempty
    create 755 www
    sharedscripts
    postrotate
        [ -f /var/run/nginx.pid ] &amp;&amp; kill -USR1 \`cat /var/run/nginx.pid\`
    endscript
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li></ul><p>\u6DFB\u52A0\u6A21\u5757\u513F\u5982\u4E0B\uFF1A</p><ul><li>\u6DFB\u52A0ldap\u6A21\u5757\u513F\u7684\u652F\u6301</li><li>\u6DFB\u52A0upsync\u6A21\u5757\u513F\u7684\u652F\u6301</li></ul><h2 id="_3-\u6253\u5305" tabindex="-1"><a class="header-anchor" href="#_3-\u6253\u5305" aria-hidden="true">#</a> 3\uFF0C\u6253\u5305</h2><p>\u5982\u4E0B\u5185\u5BB9\u57FA\u4E8ECentOS7\u8FDB\u884C\u3002</p><p>\u9996\u5148\u5C06\u9879\u76EE\u514B\u9686\u5728\u4E3B\u673A\u7684root\u76EE\u5F55\u4E0B\uFF0C\u56E0\u4E3Arpmbuild\u6709\u4E0D\u5C11\u53D8\u91CF\u662F\u57FA\u4E8E\u5BB6\u76EE\u5F55\u6765\u505A\u7684\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ git clone https://github.com/eryajf/rpmbuild.git
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u914D\u7F6E\u963F\u91CC\u548Copenresty\u7684yum\u6E90\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ yum -y <span class="token function">install</span> yum-utils
$ yum-config-manager --add-repo http://mirrors.aliyun.com/repo/Centos-7.repo
$ yum-config-manager --add-repo https://openresty.org/package/centos/openresty.repo
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u5B89\u88C5\u57FA\u7840\u6784\u5EFA\u5DE5\u5177\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ yum -y <span class="token function">install</span> rpm-build redhat-rpm-config rpmdevtools
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u5B89\u88C5\u9879\u76EE\u7F16\u8BD1\u4F9D\u8D56\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ yum -y <span class="token function">install</span> gcc gcc-c++ systemtap-sdt-devel openresty-zlib-devel openresty-openssl-devel openresty-pcre-devel gd-devel openresty-openssl111-devel ccache
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u4E0B\u8F7Dspec\u4E2D\u5B9A\u4E49\u7684\u6E90\u7801\u6587\u4EF6\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u8FDB\u5165\u5230\u5DE5\u4F5C\u76EE\u5F55</span>
$ <span class="token builtin class-name">cd</span> /root/rpmbuild/SPECS/openresty/
$ spectool -g -R openresty.spec
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u6267\u884C\u6253\u5305\u547D\u4EE4\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ rpmbuild -ba openresty.spec
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u5F53\u770B\u5230\u6700\u540E\u7ED3\u679C\u8FD4\u56DE\u503C\u4E3A0\u65F6\uFF0C\u5219\u8BF4\u660E\u6784\u5EFA\u6210\u529F\u3002\u5982\u679C\u6709\u62A5\u9519\uFF0C\u5219\u6839\u636E\u62A5\u9519\u4FE1\u606F\u8FDB\u884C\u5177\u4F53\u5E94\u5BF9\u5DE5\u4F5C\u3002</p><p>\u6210\u529F\u4E4B\u540E\uFF0C\u4F1A\u5728 <code>/root/rpmbuild/RPMS</code> \u76EE\u5F55\u4E2D\u751F\u6210\u6784\u5EFA\u597D\u7684rpm\u5305\u3002</p><p>\u67E5\u770B\u6784\u5EFA\u7684\u5305\u4FE1\u606F\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token builtin class-name">cd</span> /root/rpmbuild/RPMS/x86_64
$ <span class="token function">rpm</span> -qpi openresty-1.19.9.1-1.eryajf.el7.x86_64.rpm
Name        <span class="token builtin class-name">:</span> openresty
Version     <span class="token builtin class-name">:</span> <span class="token number">1.19</span>.9.1
Release     <span class="token builtin class-name">:</span> <span class="token number">1</span>.eryajf.el7
Architecture: x86_64
Install Date: <span class="token punctuation">(</span>not installed<span class="token punctuation">)</span>
Group       <span class="token builtin class-name">:</span> System Environment/Daemons
Size        <span class="token builtin class-name">:</span> <span class="token number">3714763</span>
License     <span class="token builtin class-name">:</span> BSD
Signature   <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>none<span class="token punctuation">)</span>
Source RPM  <span class="token builtin class-name">:</span> openresty-1.19.9.1-1.eryajf.el7.src.rpm
Build Date  <span class="token builtin class-name">:</span> Thu Oct <span class="token number">21</span> <span class="token number">23</span>:00:12 <span class="token number">2021</span>
Build Host  <span class="token builtin class-name">:</span> 13264c814536
Relocations <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>not relocatable<span class="token punctuation">)</span>
Packager    <span class="token builtin class-name">:</span> https://github.com/eryajf
URL         <span class="token builtin class-name">:</span> https://openresty.org/
Summary     <span class="token builtin class-name">:</span> OpenResty, scalable web platform by extending NGINX with Lua
Description <span class="token builtin class-name">:</span>
This package contains the core server <span class="token keyword">for</span> OpenResty. Built <span class="token keyword">for</span> production
uses.

OpenResty is a full-fledged web platform by integrating the standard Nginx
core, LuaJIT, many carefully written Lua libraries, lots of high quality
3rd-party Nginx modules, and <span class="token function">most</span> of their external dependencies. It is
designed to <span class="token builtin class-name">help</span> developers easily build scalable web applications, web
services, and dynamic web gateways.

By taking advantage of various well-designed Nginx modules <span class="token punctuation">(</span>most of <span class="token function">which</span>
are developed by the OpenResty team themselves<span class="token punctuation">)</span>, OpenResty effectively
turns the nginx server into a powerful web app server, <span class="token keyword">in</span> <span class="token function">which</span> the web
developers can use the Lua programming language to script various existing
nginx C modules and Lua modules and construct extremely high-performance
web applications that are capable to handle 10K ~ 1000K+ connections <span class="token keyword">in</span>
a single box.
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h2 id="_4-\u6A21\u5757\u513F" tabindex="-1"><a class="header-anchor" href="#_4-\u6A21\u5757\u513F" aria-hidden="true">#</a> 4\uFF0C\u6A21\u5757\u513F</h2><p>\u65E5\u5E38\u5DE5\u4F5C\u4E2D\u53EF\u80FD\u4F1A\u6709\u5176\u4ED6\u6A21\u5757\u513F\u7684\u4F7F\u7528\u573A\u666F\uFF0C\u4E00\u822C\u901A\u8FC7 <code>--add-module</code>\u8FDB\u884C\u6DFB\u52A0\uFF0C\u6211\u8FD9\u91CC\u76EE\u524D\u6DFB\u52A0\u4E86\u4E24\u4E2A\u6A21\u5757\u513F\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ ll
total <span class="token number">104</span>
-rw-r--r--  <span class="token number">1</span> liqilong  staff    12K <span class="token number">10</span> <span class="token number">21</span> <span class="token number">14</span>:59 openresty-ldap.spec
-rw-r--r--  <span class="token number">1</span> liqilong  staff    12K <span class="token number">10</span> <span class="token number">21</span> <span class="token number">14</span>:58 openresty-upsync.spec
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div>`,30),v=s("\u4E00\u4E2A\u662F\u652F\u6301\u57FA\u4E8Eldap\u505A\u8BA4\u8BC1\u7684ldap\u6A21\u5757\u513F\u3002\u914D\u7F6E\u53C2\u8003\uFF1A"),f={href:"https://wiki.eryajf.net/pages/3416.html#_6-nginx",target:"_blank",rel:"noopener noreferrer"},x=s("\u70B9\u6211"),_=n("p",null,"\u4E00\u4E2A\u662F\u5FAE\u535A\u5F00\u6E90\u7684\u80FD\u591F\u57FA\u4E8Econsul\u505A\u914D\u7F6E\u4E2D\u5FC3\u7684upsync\u6A21\u5757\u513F\u3002",-1),w=n("p",null,"\u5982\u679C\u4F60\u5728\u4F7F\u7528\u8FC7\u7A0B\u4E2D\u6709\u4EC0\u4E48\u95EE\u9898\uFF0C\u6B22\u8FCE\u7559\u8A00\u4EA4\u6D41\u3002",-1);function R(S,$){const a=p("ExternalLinkIcon");return l(),r(t,null,[u,b,n("ul",null,[n("li",null,[n("a",m,[d,e(a)])]),n("li",null,[n("a",g,[k,e(a)]),h])]),y,n("p",null,[v,n("a",f,[x,e(a)])]),_,w],64)}var L=i(o,[["render",R]]);export{L as default};

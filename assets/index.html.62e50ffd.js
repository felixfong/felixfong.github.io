import{r as t,o,c as l,b as s,a as p,F as c,e,d as n}from"./app.dbf5d933.js";import{_ as r}from"./plugin-vue_export-helper.21dcd24c.js";const u={},i=e('<h2 id="_1-\u524D\u7F6E\u51C6\u5907" tabindex="-1"><a class="header-anchor" href="#_1-\u524D\u7F6E\u51C6\u5907" aria-hidden="true">#</a> 1\uFF0C\u524D\u7F6E\u51C6\u5907</h2><h3 id="_1-\u65B9\u6848\u9009\u578B" tabindex="-1"><a class="header-anchor" href="#_1-\u65B9\u6848\u9009\u578B" aria-hidden="true">#</a> 1\uFF0C\u65B9\u6848\u9009\u578B</h3><p>\u8FD9\u91CC\u9009\u7528\u7684\u65B9\u6848\u662F\uFF1ANginx\u7ED3\u5408upsync\u6A21\u5757\u513F\uFF0C\u7ED3\u5408consul\u914D\u7F6E\u7BA1\u7406\uFF0C\u5B9E\u73B0\u540E\u7AEFupstream\u7684\u52A8\u6001\u7BA1\u7406\u3002</p><ul><li>\u9009\u7528upsync\u6709\u5982\u4E0B\u7279\u6027\uFF1A <ul><li>\u4F18\u70B9\uFF1A <ul><li>\u53EF\u4EE5\u52A8\u6001\u5BF9\u63A5etcd/consul\u83B7\u53D6upstream,\u65E0\u9700\u91CD\u542Fnginx</li><li>\u53EF\u4EE5dump\u5185\u5B58\u4E2D\u7684upstream\u914D\u7F6E\u5230\u78C1\u76D8\uFF0C\u5373\u4F7Fetcd/consul\u6302\u6389\u4ECD\u53EF\u6B63\u5E38\u8FD0\u884C</li></ul></li><li>\u7F3A\u70B9\uFF1A <ul><li>\u65E0api\u63A5\u53E3\uFF0C\u53EA\u80FD\u64CD\u4F5Cetcd/consul\u6765\u63A7\u5236upstream</li></ul></li></ul></li></ul>',4),k=n("\u6A21\u5757\u513F\u6DFB\u52A0\uFF0C\u53EF\u76F4\u63A5\u4F7F\u7528"),b={href:"https://github.com/eryajf",target:"_blank",rel:"noopener noreferrer"},m=n("\u4E8C\u4E2B"),d=n("\u4E0B\u8FB9\u5B9A\u5236\u597D\u7684spec\u6587\u4EF6\u6253\u51FArpm\u5305\uFF0C\u4FBF\u4E8E\u5B89\u88C5\u4F7F\u7528\uFF1A"),g=e(`<p>::: cardList 1</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> rpmbuild
  <span class="token key atrule">desc</span><span class="token punctuation">:</span> \u5DE5\u4F5C\u4E2D\u5E38\u7528\u7684RPM\u6784\u5EFAspec
  <span class="token key atrule">avatar</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//avatars2.githubusercontent.com/u/416130<span class="token punctuation">?</span>s=460<span class="token important">&amp;u=8753e86600e300a9811cdc539aa158deec2e2724&amp;v=4</span> <span class="token comment"># \u53EF\u9009</span>
  <span class="token key atrule">link</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/eryajf/rpmbuild <span class="token comment"># \u53EF\u9009</span>
  <span class="token key atrule">bgColor</span><span class="token punctuation">:</span> <span class="token string">&#39;#FBDE4B&#39;</span> <span class="token comment"># \u53EF\u9009\uFF0C\u9ED8\u8BA4var(--bodyBg)\u3002\u989C\u8272\u503C\u6709#\u53F7\u65F6\u8BF7\u6DFB\u52A0\u5355\u5F15\u53F7</span>
  <span class="token key atrule">textColor</span><span class="token punctuation">:</span> <span class="token string">&#39;#fff&#39;</span> <span class="token comment"># \u53EF\u9009\uFF0C\u9ED8\u8BA4var(--textColor)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>:::</p><h3 id="_2-\u89C4\u8303\u7EA6\u5B9A" tabindex="-1"><a class="header-anchor" href="#_2-\u89C4\u8303\u7EA6\u5B9A" aria-hidden="true">#</a> 2\uFF0C\u89C4\u8303\u7EA6\u5B9A</h3><ul><li><p>\u4E0D\u540C\u4E1A\u52A1\u901A\u8FC7\u4E0D\u901A\u7684 Cousul Key \u6765\u533A\u5206\u62C9\u53D6\u914D\u7F6E</p><p>\u57FA\u672C\u89C4\u5219\u4E3A: <code>{Env}/nginx/upstreams/{Service}-upsync/{Backend}</code></p><ul><li><code>Env</code>\uFF1A\u7528\u4E8E\u533A\u5206\u73AF\u5883\u3002\u6D4B\u8BD5(test)\uFF0C\u9884\u53D1(pre)\uFF0C\u7EBF\u4E0A(prod)\u3002</li><li><code>Service</code>\uFF1A\u6307\u5B9A\u4E1A\u52A1\u540D\u5B57\uFF0C\u4E00\u822C\u4E0ECMDB\u4E1A\u52A1\u540D\u5B57\u4E00\u81F4\u3002</li><li><code>Backend</code>\uFF1A\u4E0D\u540C\u540E\u7AEF\u7684\u5730\u5740\u4FE1\u606F\u3002</li></ul></li><li><p>\u7EA6\u5B9A Nginx upstream \u547D\u540D\u548C\u5E94\u7528\u6240\u5728CDMB\u7684\u96C6\u7FA4\u540D\u4FDD\u6301\u5F3A\u4E00\u81F4\u6027\uFF0C\u5168\u5C40\u552F\u4E00\u6027</p><p>\u547D\u540D\u89C4\u8303: \u5C0F\u5199\u5B57\u6BCD\u548C\u4E2D\u6A2A\u7EBF\u7EC4\u5408\uFF0C\u4EE5\u5C0F\u5199\u5B57\u6BCD\u5F00\u5934\u548C\u7ED3\u5C3E\uFF0C\u4E0D\u5141\u8BB8\u53C8\u5176\u4ED6\u7279\u6B8A\u5B57\u7B26\uFF0C\u4F8B\u5982\u4E0B\u5212\u7EBF\u7B49\uFF1B\u9488\u5BF9\u4E1A\u52A1\u96C6\u7FA4\u8FC7\u6E21\u671F\u95F4\uFF0C\u4E3A\u4E86\u533A\u5206\u63A5\u5165\u4E86\u81EA\u52A8\u6269\u7F29\u5BB9\u548C\u975E\u81EA\u52A8\u6269\u7F29\u5BB9\uFF0C\u7EDF\u4E00\u7EA6\u5B9A\u5728\u5F53\u524D {Service} \u540E\u9762\u52A0\u4E0A -upsync \u4EE5\u793A\u533A\u5206\uFF0C\u4F8B\u5982\uFF1Auser-api\uFF0C\u5728\u8FDB\u884C upsync \u81EA\u52A8\u6269\u7F29\u5BB9\u6539\u9020\u540E\uFF0C\u5176\u547D\u540D\u4E3A user-api-upsync\u3002</p></li><li><p>\u7EA6\u5B9A upsync_dump_path \u7684\u76EE\u5F55\u4E0E\u4E0A\u8FB9\u76EE\u5F55\u4FDD\u6301\u4E00\u81F4\uFF0C\u4EE5\u4FBF\u4E8E\u5BF9\u9F50\u4E24\u8005\uFF0C\u7B80\u5316\u8FD0\u7EF4\u5DE5\u4F5C\u3002</p></li></ul><h2 id="_2-nginx\u914D\u7F6E\u63A5\u5165" tabindex="-1"><a class="header-anchor" href="#_2-nginx\u914D\u7F6E\u63A5\u5165" aria-hidden="true">#</a> 2\uFF0CNginx\u914D\u7F6E\u63A5\u5165</h2><h3 id="_1-\u524D\u7F6E\u51C6\u5907-1" tabindex="-1"><a class="header-anchor" href="#_1-\u524D\u7F6E\u51C6\u5907-1" aria-hidden="true">#</a> 1\uFF0C\u524D\u7F6E\u51C6\u5907</h3>`,7),h=n("\u4E3A\u4E86\u4FBF\u4E8E\u9A8C\u8BC1\u4E00\u4E2A\u5165\u53E3\u591A\u4E2A\u540E\u7AEF\u7684\u573A\u666F\uFF0C"),f={href:"https://github.com/eryajf",target:"_blank",rel:"noopener noreferrer"},v=n("\u4E8C\u4E2B"),y=n("\u5148\u901A\u8FC7Nginx\u51C6\u5907\u4E09\u4E2A\u540E\u7AEF\u670D\u52A1\uFF0C\u4E00\u987F\u64CD\u4F5C\u5982\u4E0B\uFF1A"),_=e(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u51C6\u5907\u57FA\u7840\u6587\u4EF6</span>
$ <span class="token builtin class-name">cd</span> /data/test/docker/nginx/
$ <span class="token function">mkdir</span> test1 test2 test3
$ <span class="token builtin class-name">echo</span> test1 <span class="token operator">&gt;</span> test1/index.html
$ <span class="token builtin class-name">echo</span> test2 <span class="token operator">&gt;</span> test2/index.html
$ <span class="token builtin class-name">echo</span> test3 <span class="token operator">&gt;</span> test3/index.html
<span class="token comment"># \u542F\u52A8\u670D\u52A1</span>
$ docker run --name test1 -v /data/test/docker/nginx/test1:/usr/share/nginx/html:ro -d -p <span class="token number">9901</span>:80  daocloud.io/library/nginx:1.15.9-alpine-perl
$ docker run --name test2 -v /data/test/docker/nginx/test2:/usr/share/nginx/html:ro -d -p <span class="token number">9902</span>:80  daocloud.io/library/nginx:1.15.9-alpine-perl
$ docker run --name test3 -v /data/test/docker/nginx/test3:/usr/share/nginx/html:ro -d -p <span class="token number">9903</span>:80  daocloud.io/library/nginx:1.15.9-alpine-perl
<span class="token comment"># \u8BBF\u95EE\u9A8C\u8BC1</span>
$ <span class="token function">curl</span> localhost:9901
test1
$ <span class="token function">curl</span> localhost:9902
test2
$ <span class="token function">curl</span> localhost:9903
test3
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>\u73B0\u5728\u6709\u4E86\u4E09\u4E2A\u540E\u7AEF\uFF0C\u8BBF\u95EE\u4E4B\u540E\u80FD\u591F\u8FD4\u56DE\u5BF9\u5E94\u7684\u6807\u8BC6\u3002</p><h3 id="_2-\u4E3B\u8981\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_2-\u4E3B\u8981\u914D\u7F6E" aria-hidden="true">#</a> 2\uFF0C\u4E3B\u8981\u914D\u7F6E</h3><p>\u63A5\u4E0B\u6765\u8FDB\u5165Nginx\u7684\u4E3B\u8981\u914D\u7F6E\u9636\u6BB5\uFF0C\u5C06\u5982\u4E0B\u5185\u5BB9\u653E\u5230Nginx\u7684http\u533A\u57DF\uFF1A</p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">upstream</span> eryajf-test-upsync</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">upsync</span> 127.0.0.1:8500/v1/kv/prod/nginx/upstreams/eryajf-test-upsync/ upsync_timeout=2m upsync_interval=2s upsync_type=consul strong_dependency=off</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">upsync_dump_path</span> /etc/nginx/upsync/eryajf-test-upsync.config</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">include</span> /etc/nginx/upsync/eryajf-test-upsync.config</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span> <span class="token number">66</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span> localhost</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">proxy_pass</span> http://eryajf-test-upsync</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_set_header</span> X-Forwarded-For <span class="token variable">$remote_addr</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment"># \u4FBF\u4E8E\u89C2\u6D4B\u540E\u7AEF\u4EE3\u7406\u5217\u8868</span>
    <span class="token directive"><span class="token keyword">location</span> /upstream_list</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">upstream_show</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><ul><li><code>upsync</code>\uFF1A\u5B9A\u4E49\u4ECEconsul\u62C9\u53D6\u6700\u65B0\u7684upstream\u4FE1\u606F\u5E76\u5B58\u5230\u672C\u5730\u7684\u64CD\u4F5C\u3002 <ul><li><code>127.0.0.1:8500</code>\uFF1A\u5EFA\u8BAE\u662F\u5728\u6BCF\u53F0Nginx\u90E8\u7F72\u4E00\u4E2Aconsul-client\uFF0C\u7EDF\u4E00\u8BF7\u6C42127\uFF0C\u964D\u4F4Eserver\u7AEF\u538B\u529B\u3002</li><li><code>upsync_timeout</code>\uFF1A\u5B9A\u4E49\u4ECEconsul\u62C9\u53D6\u914D\u7F6E\u7684\u8D85\u65F6\u65F6\u95F4\u3002</li><li><code>upsync_interval</code>\uFF1A\u5B9A\u4E49\u4ECEconsul\u62C9\u53D6\u914D\u7F6E\u7684\u95F4\u9694\u65F6\u95F4</li><li><code>upsync_type</code>\uFF1A\u914D\u7F6E\u540C\u6B65\u63A5\u5165\u7C7B\u578B\uFF0Cconsul\u6216\u8005etcd\u3002</li><li><code>strong_dependency</code>\uFF1A\u542F\u52A8\u65F6\u662F\u5426\u5F3A\u5236\u4F9D\u8D56\u914D\u7F6E\u670D\u52A1\u5668\uFF0C\u5982\u679C\u914D\u7F6E\u4E3Aon,\u5219\u62C9\u53D6\u5931\u8D25\uFF0Cnginx\u540C\u6837\u4F1A\u542F\u7528\u5931\u8D25\u3002</li></ul></li><li><code>upsync_dump_path</code>\uFF1A\u5B9A\u4E49\u672C\u5730\u6301\u4E45\u5316\u76EE\u5F55\uFF0C\u5982\u679Cconsul\u670D\u52A1\u4E0D\u53EF\u7528\uFF0CNginx\u5C06\u4F1A\u5F15\u7528\u6B64\u8DEF\u5F84\u3002\u4E00\u822C\u8FD9\u4E2A\u8DEF\u5F84\u5E94\u4E0Econsul\u4E2D\u7684path\u4E00\u81F4\u3002\u6B64\u6587\u4EF6\u9700\u8981\u9884\u5148\u521B\u5EFA\uFF0C\u5E76\u4E14\u5185\u5BB9\u4E0E\u540E\u7AEF\u914D\u7F6E\u4E00\u81F4\u3002\u5426\u5219\u5C06\u68C0\u6D4B\u5931\u8D25\u3002</li><li><code>include</code>\uFF1A\u5982\u679Cconsul\u670D\u52A1\u4E0D\u53EF\u7528\uFF0C\u5C06\u4F1A\u4ECE\u4E0A\u8FB9dump\u7684\u8DEF\u5F84\u8BFB\u53D6\u5BF9\u5E94\u7684\u914D\u7F6E\u3002</li></ul><h2 id="_3-\u8C03\u8BD5\u9A8C\u8BC1" tabindex="-1"><a class="header-anchor" href="#_3-\u8C03\u8BD5\u9A8C\u8BC1" aria-hidden="true">#</a> 3\uFF0C\u8C03\u8BD5\u9A8C\u8BC1</h2><h3 id="_1-\u6DFB\u52A0\u8282\u70B9" tabindex="-1"><a class="header-anchor" href="#_1-\u6DFB\u52A0\u8282\u70B9" aria-hidden="true">#</a> 1\uFF0C\u6DFB\u52A0\u8282\u70B9</h3><p>\u6B64\u65F6\u53EF\u901A\u8FC7\u5982\u4E0B\u8BF7\u6C42\u6DFB\u52A0\u4E00\u4E2A\u540E\u7AEF\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">curl</span> -X PUT -d <span class="token string">&#39;{&quot;weight&quot;:1, &quot;max_fails&quot;:2, &quot;fail_timeout&quot;:10}&#39;</span> http://127.0.0.1:8500/v1/kv/prod/nginx/upstreams/eryajf-test-upsync/10.6.6.66:9901
<span class="token boolean">true</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u8FD4\u56DEtrue\u8BF4\u660E\u6DFB\u52A0\u6210\u529F\u3002</p><p>\u6B64\u65F6\u53EF\u5728\u5982\u4E0B\u4E09\u4E2A\u5730\u65B9\u770B\u5230\u6B64\u914D\u7F6E\uFF1A</p><ul><li><p><code>upsync_dump_path</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">cat</span> /etc/nginx/upsync/eryajf-test-upsync.config
server <span class="token number">10.6</span>.6.66:9901 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">10</span> <span class="token assign-left variable">max_fails</span><span class="token operator">=</span><span class="token number">3</span> <span class="token assign-left variable">fail_timeout</span><span class="token operator">=</span>10s<span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li><li><p><code>server_upstream_list</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">curl</span> http://10.6.6.66:66/upstream_list
Upstream name: eryajf-test-upsync<span class="token punctuation">;</span> Backend server count: <span class="token number">1</span>
        server <span class="token number">10.6</span>.6.66:9901 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">10</span> <span class="token assign-left variable">max_fails</span><span class="token operator">=</span><span class="token number">3</span> <span class="token assign-left variable">fail_timeout</span><span class="token operator">=</span>10s<span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li><li><p><code>consul_server</code></p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>$ curl -s http<span class="token operator">:</span><span class="token comment">//10.6.6.66:8500/v1/kv/?recurse | jq</span>
<span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;LockIndex&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;prod/nginx/upstreams/eryajf-test-upsync/10.6.6.66:9901&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Flags&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eyJ3ZWlnaHQiOjEwLCJtYXhfZmFpbHMiOjMsImZhaWxfdGltZW91dCI6MTAsImRvd24iOjB9&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;CreateIndex&quot;</span><span class="token operator">:</span> <span class="token number">14013</span><span class="token punctuation">,</span>
    <span class="token property">&quot;ModifyIndex&quot;</span><span class="token operator">:</span> <span class="token number">14022</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>\u5176\u4E2D\u7684Value\u662F\u7ECF\u8FC7base64\u8FC7\u7684\uFF0C\u4F7F\u7528\u5982\u4E0B\u547D\u4EE4\u53EF\u67E5\u770B\u539F\u5185\u5BB9\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>$ echo &#39;eyJ3ZWlnaHQiOjEwLCJtYXhfZmFpbHMiOjMsImZhaWxfdGltZW91dCI6MTAsImRvd24iOjB9&#39; | base64 -d | jq
<span class="token punctuation">{</span>
  <span class="token property">&quot;weight&quot;</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  <span class="token property">&quot;max_fails&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token property">&quot;fail_timeout&quot;</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  <span class="token property">&quot;down&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u4EE5\u53CA\u4ECEweb\u754C\u9762\u4E5F\u53EF\u4EE5\u76F4\u63A5\u770B\u5230\uFF1A</p><p><img src="http://t.eryajf.net/imgs/2021/11/f6e55fb80d9c7154.jpg" alt=""></p></li></ul><h3 id="_2-\u518D\u52A0\u8282\u70B9" tabindex="-1"><a class="header-anchor" href="#_2-\u518D\u52A0\u8282\u70B9" aria-hidden="true">#</a> 2\uFF0C\u518D\u52A0\u8282\u70B9</h3><p>\u8FD9\u4E2A\u65F6\u5019\u518D\u5C06\u53E6\u5916\u4E24\u4E2A\u8282\u70B9\u52A0\u4E0A\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">curl</span> -X PUT -d <span class="token string">&#39;{&quot;weight&quot;:1, &quot;max_fails&quot;:2, &quot;fail_timeout&quot;:10}&#39;</span> http://127.0.0.1:8500/v1/kv//prod/nginx/upstreams/eryajf-test-upsync/10.6.6.66:9902
$ <span class="token function">curl</span> -X PUT -d <span class="token string">&#39;{&quot;weight&quot;:1, &quot;max_fails&quot;:2, &quot;fail_timeout&quot;:10}&#39;</span> http://127.0.0.1:8500/v1/kv//prod/nginx/upstreams/eryajf-test-upsync/10.6.6.66:9903
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u518D\u6B21\u67E5\u770B\u5982\u4E0A\u4E09\u4E2A\u4FE1\u606F\uFF1A</p><ul><li><p><code>upsync_dump_path</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">cat</span> /etc/nginx/upsync/eryajf-test-upsync.config
server <span class="token number">10.6</span>.6.66:9903 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">max_fails</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">fail_timeout</span><span class="token operator">=</span>10s<span class="token punctuation">;</span>
server <span class="token number">10.6</span>.6.66:9902 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">max_fails</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">fail_timeout</span><span class="token operator">=</span>10s<span class="token punctuation">;</span>
server <span class="token number">10.6</span>.6.66:9901 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">max_fails</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">fail_timeout</span><span class="token operator">=</span>10s<span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li><li><p><code>server_upstream_list</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">curl</span> http://10.6.6.66:66/upstream_list
Upstream name: eryajf-test-upsync<span class="token punctuation">;</span> Backend server count: <span class="token number">3</span>
        server <span class="token number">10.6</span>.6.66:9903 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">max_fails</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">fail_timeout</span><span class="token operator">=</span>10s<span class="token punctuation">;</span>
        server <span class="token number">10.6</span>.6.66:9902 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">max_fails</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">fail_timeout</span><span class="token operator">=</span>10s<span class="token punctuation">;</span>
        server <span class="token number">10.6</span>.6.66:9901 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">max_fails</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">fail_timeout</span><span class="token operator">=</span>10s<span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li><li><p><code>consul_server</code></p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>$ curl -s http<span class="token operator">:</span><span class="token comment">//10.6.6.66:8500/v1/kv/?recurse | jq</span>
<span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;LockIndex&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;prod/nginx/upstreams/eryajf-test-upsync/10.6.6.66:9901&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Flags&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eyJ3ZWlnaHQiOjEsICJtYXhfZmFpbHMiOjIsICJmYWlsX3RpbWVvdXQiOjEwfQ==&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;CreateIndex&quot;</span><span class="token operator">:</span> <span class="token number">25518</span><span class="token punctuation">,</span>
    <span class="token property">&quot;ModifyIndex&quot;</span><span class="token operator">:</span> <span class="token number">25518</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;LockIndex&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;prod/nginx/upstreams/eryajf-test-upsync/10.6.6.66:9902&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Flags&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eyJ3ZWlnaHQiOjEsICJtYXhfZmFpbHMiOjIsICJmYWlsX3RpbWVvdXQiOjEwfQ==&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;CreateIndex&quot;</span><span class="token operator">:</span> <span class="token number">25525</span><span class="token punctuation">,</span>
    <span class="token property">&quot;ModifyIndex&quot;</span><span class="token operator">:</span> <span class="token number">25525</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;LockIndex&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;prod/nginx/upstreams/eryajf-test-upsync/10.6.6.66:9903&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Flags&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eyJ3ZWlnaHQiOjEsICJtYXhfZmFpbHMiOjIsICJmYWlsX3RpbWVvdXQiOjEwfQ==&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;CreateIndex&quot;</span><span class="token operator">:</span> <span class="token number">25527</span><span class="token punctuation">,</span>
    <span class="token property">&quot;ModifyIndex&quot;</span><span class="token operator">:</span> <span class="token number">25527</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div></li></ul><p>\u6B64\u65F6\u8BBF\u95EE\u4E09\u6B21\u5165\u53E3\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> a b c<span class="token punctuation">;</span><span class="token keyword">do</span> <span class="token builtin class-name">echo</span> <span class="token variable">$i</span> <span class="token operator">&amp;&amp;</span> <span class="token function">curl</span> localhost:66 <span class="token punctuation">;</span><span class="token keyword">done</span>
a
test3
b
test2
c
test1
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_3-\u4E0B\u7EBF\u8282\u70B9" tabindex="-1"><a class="header-anchor" href="#_3-\u4E0B\u7EBF\u8282\u70B9" aria-hidden="true">#</a> 3\uFF0C\u4E0B\u7EBF\u8282\u70B9</h3>`,21),q=n("\u4E0B\u7EBF\u67D0\u4E2A\u540E\u7AEF\uFF0C\u56E0\u4E3ANginx\u4E0D\u80FD\u5C06\u6743\u91CDweight\u7F6E\u4E3A0\uFF0C\u6240\u4EE5"),x={href:"https://github.com/eryajf",target:"_blank",rel:"noopener noreferrer"},w=n("\u4E8C\u4E2B"),j=n("\u64CD\u4F5Cdown\u5B57\u6BB5\u6765\u5B9E\u73B0\u4E0B\u7EBF\u4E00\u4E2A\u540E\u7AEF\uFF1A"),C=e(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">curl</span> -X PUT -d <span class="token string">&#39;{&quot;weight&quot;:1, &quot;max_fails&quot;:2, &quot;fail_timeout&quot;:10, &quot;down&quot;:1}&#39;</span> http://127.0.0.1:8500/v1/kv/prod/nginx/upstreams/eryajf-test-upsync/10.6.6.66:9902
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>\u7136\u540E\u770B\u5230\u76F8\u5E94\u7684\u53D8\u5316\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">cat</span> /etc/nginx/upsync/eryajf-test-upsync.config
server <span class="token number">10.6</span>.6.66:9903 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">max_fails</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">fail_timeout</span><span class="token operator">=</span>10s<span class="token punctuation">;</span>
server <span class="token number">10.6</span>.6.66:9902 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">max_fails</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">fail_timeout</span><span class="token operator">=</span>10s down<span class="token punctuation">;</span>
server <span class="token number">10.6</span>.6.66:9901 <span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">max_fails</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">fail_timeout</span><span class="token operator">=</span>10s<span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>\u6B64\u65F6\u8BBF\u95EE\u4E09\u6B21\u5165\u53E3\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> a b c<span class="token punctuation">;</span><span class="token keyword">do</span> <span class="token builtin class-name">echo</span> <span class="token variable">$i</span> <span class="token operator">&amp;&amp;</span> <span class="token function">curl</span> localhost:66 <span class="token punctuation">;</span><span class="token keyword">done</span>
a
test3
b
test1
c
test3
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u53EF\u4EE5\u770B\u5230\u5DF2\u7ECF\u6CA1\u6709test2\u7684\u8FD4\u56DE\u4E86\u3002</p><h2 id="_4-go\u5BA2\u6237\u7AEF" tabindex="-1"><a class="header-anchor" href="#_4-go\u5BA2\u6237\u7AEF" aria-hidden="true">#</a> 4\uFF0Cgo\u5BA2\u6237\u7AEF</h2><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;encoding/json&quot;</span>
	<span class="token string">&quot;fmt&quot;</span>

	consulapi <span class="token string">&quot;github.com/hashicorp/consul/api&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token punctuation">(</span>
	consulAddress <span class="token operator">=</span> <span class="token string">&quot;10.6.6.14:8500&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">InitConsulCli</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>consulapi<span class="token punctuation">.</span>Client <span class="token punctuation">{</span>
	config <span class="token operator">:=</span> consulapi<span class="token punctuation">.</span><span class="token function">DefaultConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	config<span class="token punctuation">.</span>Address <span class="token operator">=</span> consulAddress
	client<span class="token punctuation">,</span> err <span class="token operator">:=</span> consulapi<span class="token punctuation">.</span><span class="token function">NewClient</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		msg <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;init consul client failed,err: %v\\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token function">panic</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> client
<span class="token punctuation">}</span>

<span class="token keyword">type</span> NgConsulKey <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Env     <span class="token builtin">string</span> <span class="token string">\`json:&quot;env&quot;\`</span>
	Service <span class="token builtin">string</span> <span class="token string">\`json:&quot;service&quot;\`</span>
	Backend <span class="token builtin">string</span> <span class="token string">\`json:&quot;backend&quot;\`</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> NgConsulValue <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Weight      <span class="token builtin">int</span> <span class="token string">\`json:&quot;weight&quot;\`</span>
	MaxFails    <span class="token builtin">int</span> <span class="token string">\`json:&quot;max_fails&quot;\`</span>
	FailTimeout <span class="token builtin">int</span> <span class="token string">\`json:&quot;fail_timeout&quot;\`</span>
	Down        <span class="token builtin">int</span> <span class="token string">\`json:&quot;down&quot;\`</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">Addkv</span><span class="token punctuation">(</span>k NgConsulKey<span class="token punctuation">,</span> v NgConsulValue<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>consulapi<span class="token punctuation">.</span>WriteMeta<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	b<span class="token punctuation">,</span> err <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">Marshal</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>
	kv <span class="token operator">:=</span> <span class="token function">InitConsulCli</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">KV</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	p <span class="token operator">:=</span> <span class="token operator">&amp;</span>consulapi<span class="token punctuation">.</span>KVPair<span class="token punctuation">{</span>Key<span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;%s/nginx/upstreams/%s/%s&quot;</span><span class="token punctuation">,</span> k<span class="token punctuation">.</span>Env<span class="token punctuation">,</span> k<span class="token punctuation">.</span>Service<span class="token punctuation">,</span> k<span class="token punctuation">.</span>Backend<span class="token punctuation">)</span><span class="token punctuation">,</span> Value<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">}</span>
	wm<span class="token punctuation">,</span> err <span class="token operator">:=</span> kv<span class="token punctuation">.</span><span class="token function">Put</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> wm<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	key <span class="token operator">:=</span> NgConsulKey<span class="token punctuation">{</span>
		Env<span class="token punctuation">:</span>     <span class="token string">&quot;prod&quot;</span><span class="token punctuation">,</span>
		Service<span class="token punctuation">:</span> <span class="token string">&quot;eryajf-api-upsync&quot;</span><span class="token punctuation">,</span>
		Backend<span class="token punctuation">:</span> <span class="token string">&quot;10.6.6.66:9902&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	value <span class="token operator">:=</span> NgConsulValue<span class="token punctuation">{</span>
		Weight<span class="token punctuation">:</span>      <span class="token number">10</span><span class="token punctuation">,</span>
		MaxFails<span class="token punctuation">:</span>    <span class="token number">3</span><span class="token punctuation">,</span>
		FailTimeout<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
		Down<span class="token punctuation">:</span>        <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">Addkv</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;add kv failed:%v\\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;add kv success&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br></div></div><p>\u53EF\u4EE5\u901A\u8FC7\u8C03\u6574\u53C2\u6570\uFF0C\u6DFB\u52A0\u4E0D\u540C\u7684\u5BF9\u8C61\uFF0C\u901A\u8FC7\u8C03\u6574weight\u8C03\u6574\u540E\u7AEF\u7684\u6743\u91CD\uFF0C\u901A\u8FC7\u8C03\u6574down\u5B57\u6BB5\u6765\u51B3\u5B9A\u540E\u7AEF\u670D\u52A1\u4E0A\u4E0B\u7EBF\u3002</p><h2 id="_5-\u53C2\u8003" tabindex="-1"><a class="header-anchor" href="#_5-\u53C2\u8003" aria-hidden="true">#</a> 5\uFF0C\u53C2\u8003</h2>`,10),I={href:"https://sq.sf.163.com/blog/article/375808724630351872",target:"_blank",rel:"noopener noreferrer"},$=n("\u6548\u7387\u500D\u589E\uFF01\u7F51\u6613\u676D\u7814Nginx\u81EA\u52A8\u6269\u7F29\u5BB9\u5B9E\u8DF5");function N(M,F){const a=t("ExternalLinkIcon");return o(),l(c,null,[i,s("p",null,[k,s("a",b,[m,p(a)]),d]),g,s("p",null,[h,s("a",f,[v,p(a)]),y]),_,s("p",null,[q,s("a",x,[w,p(a)]),j]),C,s("ul",null,[s("li",null,[s("a",I,[$,p(a)])])])],64)}var B=r(u,[["render",N]]);export{B as default};
